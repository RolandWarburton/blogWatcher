<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<form
			id="myForm"
			type="POST"
			onsubmit="foo(event)"
			style="width: 60vw; margin: 10vh auto;"
		>
			<h1>Page Submitter</h1>
			<fieldset>
				<legend>Page name</legend>
				<input
					type="text"
					name="pageName"
					id="pageName"
					placeholder="pageName"
				/>
			</fieldset>
			<fieldset>
				<legend>pageSource Information</legend>
				<input
					type="text"
					name="type"
					id="type"
					placeholder="type: local or remote"
				/>
				<input type="text" name="path" id="path" placeholder="path" />
			</fieldset>
			<fieldset>
				<legend>Path usually not required if type=remote</legend>
				<input
					type="text"
					name="fsPath"
					id="fsPath"
					placeholder="fsPath"
				/>
				<input
					type="text"
					name="websitePath"
					id="websitePath"
					placeholder="websitePath (/example/page)"
				/>
				<input
					type="text"
					name="template"
					id="template"
					placeholder="template"
				/>
			</fieldset>
			<br />
			<button type="submit" id="submit">submit</button>
		</form>

		<script>
			// local or remote
			const type = document.getElementById("type");

			// fs path
			const fsPath = document.getElementById("fsPath");

			type.oninput = function () {
				fsPath.disabled = this.value != "";
			};

			function foo(event) {
				event.preventDefault();
				const form = document.querySelector("#myForm");

				// console.log(form);

				const inputs = document.getElementsByTagName("input");

				const myHeaders = new Headers();
				myHeaders.append(
					"Content-Type",
					"application/x-www-form-urlencoded"
				);

				const urlencoded = new URLSearchParams();
				// urlencoded.append("username", "AccountMaster");
				// urlencoded.append("password", "rhinos");
				// urlencoded.append(inputs[0].name, inputs[0].value);

				for (input of inputs) {
					console.log(input.name + " | " + input.value);
					urlencoded.append(input.name, input.value);
				}

				console.log(urlencoded);

				const requestOptions = {
					method: "POST",
					headers: myHeaders,
					body: urlencoded,
					redirect: "follow",
				};

				fetch("http://devel:8080/page", requestOptions)
					.then((response) => {
						console.log("hello");
						// console.log(response.json());
						return response.json();
					})
					// .then((result) => {
					// const myHeaders = new Headers();
					// myHeaders.append("auth-token", result["auth-token"]);
					// console.log("put the auth-token inside the header");
					// window.location.href = "/";
					// })
					.catch((error) => console.log("error", error));
			}
		</script>

		<style>
			body {
				background-color: #494f5c;
				color: #e8eef2;
				font-family: sans-serif;
			}

			h1 {
				margin: 0;
				padding: 0;
			}

			form {
				background-color: #3b3e48;
				color: #e8eef2;
				padding: 2em;
				margin: 2em;
			}

			fieldset {
				border-radius: 0.25em;
				color: #e8eef2;
				display: flex;
				flex-direction: row;
			}

			input {
				background-color: #2c3e50;
				color: #e8eef2;
				box-sizing: border-box;
				border: 1px solid #e8eef2;
				padding: 0.5em;
				margin: 0 2em;
			}

			input[disabled] {
				background-color: darkgray;
				color: #e8eef2;
			}
		</style>
	</body>
</html>
