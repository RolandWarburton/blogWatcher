<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<form
			id="myForm"
			type="POST"
			onsubmit="foo(event)"
			style="width: 60vw; margin: 10vh auto;"
		>
			<h1>Page Submitter</h1>
			<fieldset>
				<legend>Page name</legend>
				<input
					type="text"
					name="pageName"
					id="pageName"
					placeholder="pageName"
				/>
			</fieldset>
			<fieldset>
				<legend>pageSource Information</legend>
				<label for="remote">Tick if remote</label>
				<input type="checkbox" name="remote" id="remote"></input>
				<input type="text" name="path" id="path" placeholder="path" />
			</fieldset>
			<fieldset>
				<input
					type="text"
					name="websitePath"
					id="websitePath"
					placeholder="websitePath (/example/page)"
				/>
				<input
					type="text"
					name="template"
					id="template"
					placeholder="template"
				/>
			</fieldset>
			<br />
			<button type="submit" id="submit">submit</button>
		</form>

		<script>
			function foo(event) {
				event.preventDefault();
				const form = document.querySelector("#myForm");

				// console.log(form);

				const inputs = document.getElementsByTagName("input");

				const myHeaders = new Headers();
				myHeaders.append(
					"Content-Type",
					"application/x-www-form-urlencoded"
				);

				const urlencoded = new URLSearchParams();
				// urlencoded.append("username", "AccountMaster");
				// urlencoded.append("password", "rhinos");
				// urlencoded.append(inputs[0].name, inputs[0].value);

				for (input of inputs) {
					// console.log(input.name + " | " + input.value);

					switch (input.name) {
						case "remote":
							console.info("parsing special value: " + input.name + " " + input.value)
							if (input.value == "on") {
								console.log("remote will be true")
								urlencoded.append(input.name, true);
							}
							else {
								console.log("remote will be false")
								urlencoded.append(input.name, false);
							}
						break;
					
						default:
							console.log("parsing: " + input.name + " " + input.value)
							urlencoded.append(input.name, input.value);
						break;
					}
				}

				console.log(urlencoded);

				const requestOptions = {
					method: "POST",
					headers: myHeaders,
					body: urlencoded,
					redirect: "follow",
				};

				fetch("http://devel:8080/page", requestOptions)
					.then((response) => {
						console.log("hello");
						// console.log(response.json());
						return response.json();
					})
					// .then((result) => {
					// const myHeaders = new Headers();
					// myHeaders.append("auth-token", result["auth-token"]);
					// console.log("put the auth-token inside the header");
					// window.location.href = "/";
					// })
					.catch((error) => console.log("error", error));
			}
		</script>

		<style>
			body {
				background-color: #494f5c;
				color: #e8eef2;
				font-family: sans-serif;
			}

			h1 {
				margin: 0;
				padding: 0;
			}

			form {
				background-color: #3b3e48;
				color: #e8eef2;
				padding: 2em;
				margin: 2em;
			}

			fieldset {
				border-radius: 0.25em;
				color: #e8eef2;
				display: flex;
				flex-direction: row;
			}

			input {
				background-color: #2c3e50;
				color: #e8eef2;
				box-sizing: border-box;
				border: 1px solid #e8eef2;
				padding: 0.5em;
				margin: 0 2em;
			}

			input[disabled] {
				background-color: darkgray;
				color: #e8eef2;
			}
		</style>
	</body>
</html>
